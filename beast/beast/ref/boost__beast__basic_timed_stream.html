<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>basic_timed_stream</title>
<link rel="stylesheet" href="../../../../../../doc/src/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="../../index.html" title="Chapter&#160;1.&#160;Boost.Beast">
<link rel="up" href="../ref.html" title="This Page Intentionally Left Blank 2/2">
<link rel="prev" href="boost__beast__basic_string_view.html" title="basic_string_view">
<link rel="next" href="boost__beast__basic_timed_stream/async_read_some.html" title="basic_timed_stream::async_read_some">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../../boost.png"></td>
<td align="center"><a href="../../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="boost__beast__basic_string_view.html"><img src="../../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../ref.html"><img src="../../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="boost__beast__basic_timed_stream/async_read_some.html"><img src="../../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="beast.ref.boost__beast__basic_timed_stream"></a><a class="link" href="boost__beast__basic_timed_stream.html" title="basic_timed_stream">basic_timed_stream</a>
</h4></div></div></div>
<p>
        A stream socket wrapper with timeout support for asynchronous operations.
      </p>
<h5>
<a name="beast.ref.boost__beast__basic_timed_stream.h0"></a>
        <span class="phrase"><a name="beast.ref.boost__beast__basic_timed_stream.synopsis"></a></span><a class="link" href="boost__beast__basic_timed_stream.html#beast.ref.boost__beast__basic_timed_stream.synopsis">Synopsis</a>
      </h5>
<p>
        Defined in header <code class="literal">&lt;<a href="../../../../../../boost/beast/_experimental/core/basic_timed_stream.hpp" target="_top">boost/beast/_experimental/core/basic_timed_stream.hpp</a>&gt;</code>
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span>
    <span class="keyword">class</span> <a href="../../../../../../doc/html/boost_asio/reference/Protocol.html" target="_top"><span class="bold"><strong>Protocol</strong></span></a><span class="special">,</span>
    <span class="keyword">class</span> <a href="../../../../../../doc/html/boost_asio/reference/Executor1.html" target="_top"><span class="bold"><strong>Executor</strong></span></a><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">basic_timed_stream</span>
</pre>
<h5>
<a name="beast.ref.boost__beast__basic_timed_stream.h1"></a>
        <span class="phrase"><a name="beast.ref.boost__beast__basic_timed_stream.types"></a></span><a class="link" href="boost__beast__basic_timed_stream.html#beast.ref.boost__beast__basic_timed_stream.types">Types</a>
      </h5>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Name
                </p>
              </th>
<th>
                <p>
                  Description
                </p>
              </th>
</tr></thead>
<tbody>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream__connect_op.html" title="basic_timed_stream::connect_op"><span class="bold"><strong>connect_op</strong></span></a>
                </p>
              </td>
<td>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/executor_type.html" title="basic_timed_stream::executor_type"><span class="bold"><strong>executor_type</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  The type of the executor associated with the object.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/lowest_layer_type.html" title="basic_timed_stream::lowest_layer_type"><span class="bold"><strong>lowest_layer_type</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  The type of the lowest layer.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/next_layer_type.html" title="basic_timed_stream::next_layer_type"><span class="bold"><strong>next_layer_type</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  The type of the next layer.
                </p>
              </td>
</tr>
</tbody>
</table></div>
<h5>
<a name="beast.ref.boost__beast__basic_timed_stream.h2"></a>
        <span class="phrase"><a name="beast.ref.boost__beast__basic_timed_stream.member_functions"></a></span><a class="link" href="boost__beast__basic_timed_stream.html#beast.ref.boost__beast__basic_timed_stream.member_functions">Member
        Functions</a>
      </h5>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Name
                </p>
              </th>
<th>
                <p>
                  Description
                </p>
              </th>
</tr></thead>
<tbody>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/async_read_some.html" title="basic_timed_stream::async_read_some"><span class="bold"><strong>async_read_some</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  Start an asynchronous read.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/async_write_some.html" title="basic_timed_stream::async_write_some"><span class="bold"><strong>async_write_some</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  Start an asynchronous write.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/basic_timed_stream.html" title="basic_timed_stream::basic_timed_stream"><span class="bold"><strong>basic_timed_stream</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  Constructor.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/close.html" title="basic_timed_stream::close"><span class="bold"><strong>close</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  Close the timed stream.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/expires_after.html" title="basic_timed_stream::expires_after"><span class="bold"><strong>expires_after</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  Set the timeout for the next logical operation.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/expires_at.html" title="basic_timed_stream::expires_at"><span class="bold"><strong>expires_at</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  Set the timeout for the next logical operation.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/expires_never.html" title="basic_timed_stream::expires_never"><span class="bold"><strong>expires_never</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  Disable the timeout for the next logical operation.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/get_executor.html" title="basic_timed_stream::get_executor"><span class="bold"><strong>get_executor</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  Get the executor associated with the object.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/lowest_layer.html" title="basic_timed_stream::lowest_layer"><span class="bold"><strong>lowest_layer</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  Get a reference to the lowest layer.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/next_layer.html" title="basic_timed_stream::next_layer"><span class="bold"><strong>next_layer</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  Get a reference to the next layer.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <a class="link" href="boost__beast__basic_timed_stream/basic_timed_stream_dtor_.html" title="basic_timed_stream::~basic_timed_stream"><span class="bold"><strong>~basic_timed_stream</strong></span></a>
                </p>
              </td>
<td>
                <p>
                  Destructor.
                </p>
              </td>
</tr>
</tbody>
</table></div>
<h5>
<a name="beast.ref.boost__beast__basic_timed_stream.h3"></a>
        <span class="phrase"><a name="beast.ref.boost__beast__basic_timed_stream.description"></a></span><a class="link" href="boost__beast__basic_timed_stream.html#beast.ref.boost__beast__basic_timed_stream.description">Description</a>
      </h5>
<p>
        This wraps a normal stream socket and implements a simple and efficient timeout
        for logical asynchronous operations.
      </p>
<h5>
<a name="beast.ref.boost__beast__basic_timed_stream.h4"></a>
        <span class="phrase"><a name="beast.ref.boost__beast__basic_timed_stream.usage"></a></span><a class="link" href="boost__beast__basic_timed_stream.html#beast.ref.boost__beast__basic_timed_stream.usage">Usage</a>
      </h5>
<p>
        To use this stream declare an instance of the class. Then, before each logical
        operation for which a timeout is desired, call <a class="link" href="boost__beast__basic_timed_stream/expires_after.html" title="basic_timed_stream::expires_after"><code class="computeroutput"><span class="identifier">basic_timed_stream</span><span class="special">::</span><span class="identifier">expires_after</span></code></a> with a duration, or
        call <a class="link" href="boost__beast__basic_timed_stream/expires_at.html" title="basic_timed_stream::expires_at"><code class="computeroutput"><span class="identifier">basic_timed_stream</span><span class="special">::</span><span class="identifier">expires_at</span></code></a> with a time point. Alternatively,
        call <a class="link" href="boost__beast__basic_timed_stream/expires_never.html" title="basic_timed_stream::expires_never"><code class="computeroutput"><span class="identifier">basic_timed_stream</span><span class="special">::</span><span class="identifier">expires_never</span></code></a> to disable the timeout
        for subsequent logical operations.
      </p>
<p>
        A logical operation is defined as one of the following:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
            A call to <a class="link" href="boost__beast__async_connect.html" title="async_connect"><code class="computeroutput"><span class="identifier">async_connect</span></code></a> where the timed
            stream is passed as the first argument.
          </li>
<li class="listitem">
            One or more calls to either one or both of the stream's <a class="link" href="boost__beast__basic_timed_stream/async_read_some.html" title="basic_timed_stream::async_read_some"><code class="computeroutput"><span class="identifier">basic_timed_stream</span><span class="special">::</span><span class="identifier">async_read_some</span></code></a> and <a class="link" href="boost__beast__basic_timed_stream/async_write_some.html" title="basic_timed_stream::async_write_some"><code class="computeroutput"><span class="identifier">basic_timed_stream</span><span class="special">::</span><span class="identifier">async_write_some</span></code></a> member functions.
            This also includes indirect calls, for example when passing the stream
            as the first argument to an initiating function such as <code class="computeroutput"><span class="identifier">net</span><span class="special">::</span><span class="identifier">async_read_until</span></code>.
          </li>
</ul></div>
<p>
        Each logical operation can be considered as peforming just reads, just writes,
        or both reads and writes. Calls to <a class="link" href="boost__beast__async_connect.html" title="async_connect"><code class="computeroutput"><span class="identifier">async_connect</span></code></a> count as both a read
        and a write, although no actual reads or writes are performed. While logical
        operations can include both reading and writing, the usual restriction on
        having at most one read and one write outstanding simultaneously applies.
      </p>
<p>
        The implementation maintains two timers: one timer for reads, and another
        timer for writes. When the expiration time is adjusted (by calling <a class="link" href="boost__beast__basic_timed_stream/expires_after.html" title="basic_timed_stream::expires_after"><code class="computeroutput"><span class="identifier">basic_timed_stream</span><span class="special">::</span><span class="identifier">expires_after</span></code></a> or <a class="link" href="boost__beast__basic_timed_stream/expires_at.html" title="basic_timed_stream::expires_at"><code class="computeroutput"><span class="identifier">basic_timed_stream</span><span class="special">::</span><span class="identifier">expires_at</span></code></a>), the indiviudal timer
        is only set if there is not currently an operation of that type (read or
        write) outstanding. It is undefined behavior to set an expiration when there
        is both a read and a write pending, since there would be no available timer
        to apply the expiration to.
      </p>
<h5>
<a name="beast.ref.boost__beast__basic_timed_stream.h5"></a>
        <span class="phrase"><a name="beast.ref.boost__beast__basic_timed_stream.example"></a></span><a class="link" href="boost__beast__basic_timed_stream.html#beast.ref.boost__beast__basic_timed_stream.example">Example</a>
      </h5>
<p>
        This code sets a timeout, and uses a generic networking stream algorithm
        to read data from a timed stream until a particular delimiter is found or
        until the stream times out:
      </p>
<pre class="programlisting"><span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">Protocol</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">Executor</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">ReadHandler</span><span class="special">&gt;</span>
<span class="keyword">void</span> <span class="identifier">async_read_line</span> <span class="special">(</span>
    <span class="identifier">basic_timed_stream</span><span class="special">&lt;</span><span class="identifier">Protocol</span><span class="special">,</span> <span class="identifier">Executor</span><span class="special">&gt;&amp;</span> <span class="identifier">stream</span><span class="special">,</span>
    <span class="identifier">net</span><span class="special">::</span><span class="identifier">streambuf</span><span class="special">&amp;</span> <span class="identifier">buffer</span><span class="special">,</span> <span class="identifier">ReadHandler</span><span class="special">&amp;&amp;</span> <span class="identifier">handler</span><span class="special">)</span>
<span class="special">{</span>
    <span class="identifier">stream</span><span class="special">.</span><span class="identifier">expires_after</span> <span class="special">(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">chrono</span><span class="special">::</span><span class="identifier">seconds</span><span class="special">(</span><span class="number">30</span><span class="special">));</span>

    <span class="identifier">net</span><span class="special">::</span><span class="identifier">async_read_until</span> <span class="special">(</span><span class="identifier">stream</span><span class="special">,</span> <span class="identifier">buffer</span><span class="special">,</span> <span class="string">"\r\n"</span><span class="special">,</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">forward</span><span class="special">&lt;</span><span class="identifier">ReadHandler</span><span class="special">&gt;(</span><span class="identifier">handler</span><span class="special">));</span>
<span class="special">}</span>
</pre>
<p>
        When a timeout occurs the socket will be closed, canceling any pending I/O
        operations. The completion handlers for these canceled operations will be
        invoked with the error <a class="link" href="boost__beast__error.html" title="error"><code class="computeroutput"><span class="identifier">timeout</span></code></a>.
      </p>
<h5>
<a name="beast.ref.boost__beast__basic_timed_stream.h6"></a>
        <span class="phrase"><a name="beast.ref.boost__beast__basic_timed_stream.template_parameters"></a></span><a class="link" href="boost__beast__basic_timed_stream.html#beast.ref.boost__beast__basic_timed_stream.template_parameters">Template
        Parameters</a>
      </h5>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Type
                </p>
              </th>
<th>
                <p>
                  Description
                </p>
              </th>
</tr></thead>
<tbody>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">Protocol</span></code>
                </p>
              </td>
<td>
                <p>
                  A type meeting the requirements of Protocol representing the protocol
                  the protocol to use for the basic stream socket. A common choice
                  is <code class="computeroutput"><span class="identifier">net</span><span class="special">::</span><span class="identifier">ip</span><span class="special">::</span><span class="identifier">tcp</span></code>.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">Executor</span></code>
                </p>
              </td>
<td>
                <p>
                  A type meeting the requirements of Executor to be used for submitting
                  all completion handlers which do not already have an associated
                  executor.
                </p>
              </td>
</tr>
</tbody>
</table></div>
<h5>
<a name="beast.ref.boost__beast__basic_timed_stream.h7"></a>
        <span class="phrase"><a name="beast.ref.boost__beast__basic_timed_stream.remarks"></a></span><a class="link" href="boost__beast__basic_timed_stream.html#beast.ref.boost__beast__basic_timed_stream.remarks">Remarks</a>
      </h5>
<p>
        A timed stream object must not be moved or destroyed while there are oustanding
        asynchronous operations associated with it. Objects of this type meet the
        requirements of <span class="bold"><strong>AsyncReadStream</strong></span> and <span class="bold"><strong>AsyncWriteStream</strong></span>.
      </p>
<h5>
<a name="beast.ref.boost__beast__basic_timed_stream.h8"></a>
        <span class="phrase"><a name="beast.ref.boost__beast__basic_timed_stream.thread_safety"></a></span><a class="link" href="boost__beast__basic_timed_stream.html#beast.ref.boost__beast__basic_timed_stream.thread_safety">Thread
        Safety</a>
      </h5>
<p>
        <span class="emphasis"><em>Distinct</em></span> <span class="emphasis"><em>objects:</em></span> Safe.
      </p>
<p>
        <span class="emphasis"><em>Shared</em></span> <span class="emphasis"><em>objects:</em></span> Unsafe.
      </p>
<p>
        The application must also ensure that all asynchronous operations are performed
        within the same implicit or explicit strand.
      </p>
<h5>
<a name="beast.ref.boost__beast__basic_timed_stream.h9"></a>
        <span class="phrase"><a name="beast.ref.boost__beast__basic_timed_stream.see_also"></a></span><a class="link" href="boost__beast__basic_timed_stream.html#beast.ref.boost__beast__basic_timed_stream.see_also">See
        Also</a>
      </h5>
<p>
        <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1322r0.html" target="_top">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1322r0.html</a>
      </p>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2016, 2017 Vinnie Falco<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="boost__beast__basic_string_view.html"><img src="../../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../ref.html"><img src="../../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="boost__beast__basic_timed_stream/async_read_some.html"><img src="../../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
</body>
</html>
