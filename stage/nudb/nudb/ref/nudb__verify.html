<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>verify</title>
<link rel="stylesheet" href="../../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="../../index.html" title="NuDB">
<link rel="up" href="../ref.html" title="Reference">
<link rel="prev" href="nudb__system_error.html" title="system_error">
<link rel="next" href="nudb__verify_info.html" title="verify_info">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr><td valign="top"><img alt="NuDB Logo" width="1270" height="80" src="../../images/logo.png"></td></tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="nudb__system_error.html"><img src="../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../ref.html"><img src="../../images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../images/home.png" alt="Home"></a><a accesskey="n" href="nudb__verify_info.html"><img src="../../images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="nudb.ref.nudb__verify"></a><a class="link" href="nudb__verify.html" title="verify">verify</a>
</h3></div></div></div>
<p>
        <a class="indexterm" name="id995985"></a>
Verify consistency of the key and data files.
      </p>
<h5>
<a name="nudb.ref.nudb__verify.h0"></a>
        <span class="phrase"><a name="nudb.ref.nudb__verify.synopsis"></a></span><a class="link" href="nudb__verify.html#nudb.ref.nudb__verify.synopsis">Synopsis</a>
      </h5>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span>
    <span class="keyword">class</span> <span class="identifier">Hasher</span><span class="special">,</span>
    <span class="keyword">class</span> <span class="identifier">Progress</span><span class="special">&gt;</span>
<span class="keyword">void</span>
<span class="identifier">verify</span><span class="special">(</span>
    <span class="identifier">verify_info</span><span class="special">&amp;</span> <span class="identifier">info</span><span class="special">,</span>
    <span class="identifier">path_type</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">dat_path</span><span class="special">,</span>
    <span class="identifier">path_type</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">key_path</span><span class="special">,</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">size_t</span> <span class="identifier">bufferSize</span><span class="special">,</span>
    <span class="identifier">Progress</span><span class="special">&amp;&amp;</span> <span class="identifier">progress</span><span class="special">,</span>
    <span class="identifier">error_code</span><span class="special">&amp;</span> <span class="identifier">ec</span><span class="special">);</span>
</pre>
<h5>
<a name="nudb.ref.nudb__verify.h1"></a>
        <span class="phrase"><a name="nudb.ref.nudb__verify.description"></a></span><a class="link" href="nudb__verify.html#nudb.ref.nudb__verify.description">Description</a>
      </h5>
<p>
        This function opens the key and data files, and performs the following checks
        on the contents: * Data file header validity * Key file header validity *
        Data and key file header agreements * Check that each value is contained
        in a bucket * Check that each bucket item reflects a value * Ensure no values
        with duplicate keys Undefined behavior results when verifying a database
        that still has a log file. Use <a class="link" href="nudb__recover.html" title="recover"><code class="computeroutput"><span class="identifier">recover</span></code></a> on such databases first.
        This function selects one of two algorithms to use, the normal version, and
        a faster version that can take advantage of a buffer of sufficient size.
        Depending on the value of the bufferSize argument, the appropriate algorithm
        is chosen. A good value of bufferSize is one that is a large fraction of
        the key file size. For example, 20% of the size of the key file. Larger is
        better, with the highest usable value depending on the size of the key file.
        If presented with a buffer size that is too large to be of extra use, the
        fast algorithm will simply allocate what it needs.
      </p>
<h5>
<a name="nudb.ref.nudb__verify.h2"></a>
        <span class="phrase"><a name="nudb.ref.nudb__verify.template_parameters"></a></span><a class="link" href="nudb__verify.html#nudb.ref.nudb__verify.template_parameters">Template
        Parameters</a>
      </h5>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Type
                </p>
              </th>
<th>
                <p>
                  Description
                </p>
              </th>
</tr></thead>
<tbody><tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">Hasher</span></code>
                </p>
              </td>
<td>
                <p>
                  The hash function to use. This type must meet the requirements
                  of HashFunction. The hash function must be the same as that used
                  to create the database, or else an error is returned.
                </p>
              </td>
</tr></tbody>
</table></div>
<h5>
<a name="nudb.ref.nudb__verify.h3"></a>
        <span class="phrase"><a name="nudb.ref.nudb__verify.parameters"></a></span><a class="link" href="nudb__verify.html#nudb.ref.nudb__verify.parameters">Parameters</a>
      </h5>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Name
                </p>
              </th>
<th>
                <p>
                  Description
                </p>
              </th>
</tr></thead>
<tbody>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">info</span></code>
                </p>
              </td>
<td>
                <p>
                  A reference to a structure of type <span class="red">|6|verify_info</span>
                  which will be filled in. Upon return the contents of this structure
                  are defined if and only if the verify function completes successfully
                  as indicated by the ec parameter.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">dat_path</span></code>
                </p>
              </td>
<td>
                <p>
                  The path to the data file.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">key_path</span></code>
                </p>
              </td>
<td>
                <p>
                  The path to the key file.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">bufferSize</span></code>
                </p>
              </td>
<td>
                <p>
                  The number of bytes to allocate for the buffer. If this number
                  is too small, or zero, a slower algorithm will be used that does
                  not require a buffer.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">progress</span></code>
                </p>
              </td>
<td>
                <p>
                  A function address, function object or lambda with the following
                  signature:
                </p>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="keyword">void</span> <span class="identifier">progress</span><span class="special">(</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">uint64_t</span> <span class="identifier">amount</span><span class="special">,</span>   <span class="comment">// Amount of work done so far</span>
    <span class="identifier">std</span><span class="special">::</span><span class="identifier">uint64_t</span> <span class="identifier">total</span>     <span class="comment">// Total amount of work to do</span>
<span class="special">);</span>
</pre>
                <p>
                  This function will be called periodically as the algorithm proceeds
                  so that the user code can monitor the progress of the operation
                  and calculate how much time remains to complete the operation.
                  The library contains a default function object, <span class="red">|6|no_progress</span>,
                  which matches the above signature but does nothing.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">ec</span></code>
                </p>
              </td>
<td>
                <p>
                  Set to the error, if any occurred.
                </p>
              </td>
</tr>
</tbody>
</table></div>
<h5>
<a name="nudb.ref.nudb__verify.h4"></a>
        <span class="phrase"><a name="nudb.ref.nudb__verify.associated_types"></a></span><a class="link" href="nudb__verify.html#nudb.ref.nudb__verify.associated_types">Associated
        Types</a>
      </h5>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
            <a class="link" href="nudb__verify_info.html" title="verify_info"><code class="computeroutput"><span class="identifier">verify_info</span></code></a>
            - Information returned by verify function
          </li>
<li class="listitem">
            <a class="link" href="nudb__no_progress.html" title="no_progress"><code class="computeroutput"><span class="identifier">no_progress</span></code></a>
            - Function of type Progress which does nothing
          </li>
</ul></div>
<h5>
<a name="nudb.ref.nudb__verify.h5"></a>
        <span class="phrase"><a name="nudb.ref.nudb__verify.header"></a></span><a class="link" href="nudb__verify.html#nudb.ref.nudb__verify.header">Header</a>
      </h5>
<p>
        <code class="computeroutput"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">nudb</span><span class="special">/</span><span class="identifier">verify</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span></code>
      </p>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2015, 2016 Vinnie Falco<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="nudb__system_error.html"><img src="../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../ref.html"><img src="../../images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../images/home.png" alt="Home"></a><a accesskey="n" href="nudb__verify_info.html"><img src="../../images/next.png" alt="Next"></a>
</div>
</body>
</html>
