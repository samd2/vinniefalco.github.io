<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>recover</title>
<link rel="stylesheet" href="../../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="../../index.html" title="NuDB">
<link rel="up" href="../ref.html" title="Reference">
<link rel="prev" href="nudb__posix_file/_posix_file.html" title="posix_file::~posix_file">
<link rel="next" href="nudb__rekey.html" title="rekey">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr><td valign="top"><img alt="NuDB Logo" width="1270" height="80" src="../../images/logo.png"></td></tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="nudb__posix_file/_posix_file.html"><img src="../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../ref.html"><img src="../../images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../images/home.png" alt="Home"></a><a accesskey="n" href="nudb__rekey.html"><img src="../../images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="nudb.ref.nudb__recover"></a><a class="link" href="nudb__recover.html" title="recover">recover</a>
</h3></div></div></div>
<p>
        <a class="indexterm" name="id994252"></a>
Perform recovery on a database.
      </p>
<h5>
<a name="nudb.ref.nudb__recover.h0"></a>
        <span class="phrase"><a name="nudb.ref.nudb__recover.synopsis"></a></span><a class="link" href="nudb__recover.html#nudb.ref.nudb__recover.synopsis">Synopsis</a>
      </h5>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span>
    <span class="keyword">class</span> <span class="identifier">Hasher</span><span class="special">,</span>
    <span class="keyword">class</span> <span class="identifier">File</span> <span class="special">=</span> <span class="identifier">native_file</span><span class="special">,</span>
    <span class="keyword">class</span><span class="special">...</span> <span class="identifier">Args</span><span class="special">&gt;</span>
<span class="keyword">void</span>
<span class="identifier">recover</span><span class="special">(</span>
    <span class="identifier">path_type</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">dat_path</span><span class="special">,</span>
    <span class="identifier">path_type</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">key_path</span><span class="special">,</span>
    <span class="identifier">path_type</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">log_path</span><span class="special">,</span>
    <span class="identifier">error_code</span><span class="special">&amp;</span> <span class="identifier">ec</span><span class="special">,</span>
    <span class="identifier">Args</span><span class="special">&amp;&amp;...</span> <span class="identifier">args</span><span class="special">);</span>
</pre>
<h5>
<a name="nudb.ref.nudb__recover.h1"></a>
        <span class="phrase"><a name="nudb.ref.nudb__recover.description"></a></span><a class="link" href="nudb__recover.html#nudb.ref.nudb__recover.description">Description</a>
      </h5>
<p>
        This implements the recovery algorithm by rolling back any partially committed
        data. If no log file is present, the function does nothing.
      </p>
<p>
        During the commit phase of a NuDB database, a log file is generated with
        information that may be used to roll back the results of a partial commit.
        This function checks for the presence of a log file. If present, the log
        file is replayed on the key and data files belonging to the database, restoring
        the database to its state before the partial commit. When <a class="link" href="nudb__recover.html" title="recover"><code class="computeroutput"><span class="identifier">recover</span></code></a> is successful, it erases
        the log file.
      </p>
<p>
        It is normally not necessary to call this function directly, it is called
        automatically when a database is opened in a call to <a class="link" href="nudb__basic_store/open.html" title="basic_store::open"><code class="computeroutput"><span class="identifier">basic_store</span><span class="special">::</span><span class="identifier">open</span></code></a>. Callers may use this function
        to implement auxiliary tools for manipulating the database.
      </p>
<h5>
<a name="nudb.ref.nudb__recover.h2"></a>
        <span class="phrase"><a name="nudb.ref.nudb__recover.template_parameters"></a></span><a class="link" href="nudb__recover.html#nudb.ref.nudb__recover.template_parameters">Template
        Parameters</a>
      </h5>
<h5>
<a name="nudb.ref.nudb__recover.h3"></a>
        <span class="phrase"><a name="nudb.ref.nudb__recover.template_parameters0"></a></span><a class="link" href="nudb__recover.html#nudb.ref.nudb__recover.template_parameters0">Template
        Parameters</a>
      </h5>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Type
                </p>
              </th>
<th>
                <p>
                  Description
                </p>
              </th>
</tr></thead>
<tbody>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">Hasher</span></code>
                </p>
              </td>
<td>
                <p>
                  The hash function to use. This type must meet the requirements
                  of Hasher. The hash function must be the same as that used to create
                  the database, or else an error is returned.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">File</span></code>
                </p>
              </td>
<td>
                <p>
                  The type of file to use. Use the default of <span class="red">|9|native_file</span>
                  unless customizing the file behavior.
                </p>
              </td>
</tr>
</tbody>
</table></div>
<h5>
<a name="nudb.ref.nudb__recover.h4"></a>
        <span class="phrase"><a name="nudb.ref.nudb__recover.parameters"></a></span><a class="link" href="nudb__recover.html#nudb.ref.nudb__recover.parameters">Parameters</a>
      </h5>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  Name
                </p>
              </th>
<th>
                <p>
                  Description
                </p>
              </th>
</tr></thead>
<tbody>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">dat_path</span></code>
                </p>
              </td>
<td>
                <p>
                  The path to the data file.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">key_path</span></code>
                </p>
              </td>
<td>
                <p>
                  The path to the key file.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">log_path</span></code>
                </p>
              </td>
<td>
                <p>
                  The path to the log file.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">args</span></code>
                </p>
              </td>
<td>
                <p>
                  Optional parameters passed to File constructors.
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <code class="computeroutput"><span class="identifier">ec</span></code>
                </p>
              </td>
<td>
                <p>
                  Set to the error, if any occurred.
                </p>
              </td>
</tr>
</tbody>
</table></div>
<h5>
<a name="nudb.ref.nudb__recover.h5"></a>
        <span class="phrase"><a name="nudb.ref.nudb__recover.header"></a></span><a class="link" href="nudb__recover.html#nudb.ref.nudb__recover.header">Header</a>
      </h5>
<p>
        <code class="computeroutput"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">nudb</span><span class="special">/</span><span class="identifier">recover</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span></code>
      </p>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2015, 2016 Vinnie Falco<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="nudb__posix_file/_posix_file.html"><img src="../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../ref.html"><img src="../../images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../images/home.png" alt="Home"></a><a accesskey="n" href="nudb__rekey.html"><img src="../../images/next.png" alt="Next"></a>
</div>
</body>
</html>
